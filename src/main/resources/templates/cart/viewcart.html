<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>장바구니 목록</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<h1>장바구니 목록</h1>

<!-- 장바구니 목록 표시 -->
<div id="cart-list"></div>

<script>
  // 사용자의 장바구니 목록을 불러오는 함수
  function loadCart(userCode) {
    $.ajax({
      url: `/api/cart/list/${userCode}`,
      method: 'GET',
      success: function(response) {
        let cartHtml = "<ul>";
        response.forEach(cart => {
          cartHtml += `
                            <li>
                                상품 코드: ${cart.productCode},
                                상품 수량: ${cart.cartProductQuantity}
                                <button onclick="removeFromCart(${cart.cartCode})">삭제</button>
                            </li>
                        `;
        });
        cartHtml += "</ul>";
        $("#cart-list").html(cartHtml);
      },
      error: function(xhr, status, error) {
        alert("장바구니 목록을 불러오는 데 실패했습니다.");
      }
    });
  }

  // 장바구니에서 상품 제거
  function removeFromCart(cartCode) {
    $.ajax({
      url: `/api/cart/remove/${cartCode}`,
      method: 'DELETE',
      success: function(response) {
        alert("장바구니에서 상품이 제거되었습니다.");
        loadCart(1); // 사용자 코드 1번으로 장바구니 목록을 갱신
      },
      error: function(xhr, status, error) {
        alert("장바구니에서 상품을 제거하는 데 실패했습니다.");
      }
    });
  }

  // 페이지가 로드되면 장바구니 목록을 불러옴
  $(document).ready(function() {
    loadCart(1);  // 예시로 1번 사용자 장바구니 목록을 조회
  });
</script>
</body>
</html>